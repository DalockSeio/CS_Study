# 1.2 프로세스

# 1.2.3 프로세스의 생성

fork(): 부모 프로세스를 복사하여 자식 프로세스를 만드는 함수

부모 프로세스에서 fork() 호출 시,

부모 프로세스 → 자식 프로세스의 PID값 반환(부모 프로세스의 PID와는 다르다는 것 기억)

자식 프로세스 → 0 반환

# 1.2.4 프로세스 상태도

프로세스의 상태는 생성(new), 준비(ready), 대기(wating), 실행(running), 종료(terminated) 5가지이다.

- 생성(new): 프로세스가 PCB(Process Control Block)는 가지고 있지만 OS로부터 승인받기 전
- 준비(ready): OS로 부터 승인을 받아 준비 큐에서 CPU할당 대기중인 상태
- 실행(running): 프로세스가 CPU할당을 받아 실행함
- 대기(wating): 프로세스가 입출력이나 이벤트 발생을 기다려야 해서 CPU사용을 멈추고 기다림
- 종료(terminated): 프로세스 실행 종료

프로세스의 상태 변화

- 생성→준비: 생성 상태 프로세스가 OS의 허락을 받아 준비 큐에 추가됨
- 준비→실행: 준비 큐에 있는 프로세스 중 우선순위가 높은 것이 디스패치되어 실행됨
- 실행→준비: CPU 독점 방지를 위해 타임아웃되어 준비 상태로 변경됨
- 실행→대기: 입출력 혹은 이벤트 발생을 기다릴 때 변경됨
- 대기→준비: 입출력 또는 이벤트가 완료되어 준비 상태로 변경됨
- 실행→종료: 실행 중인 프로세스가 정상적으로 끝나 종료됨

# 1.2.5 멀티 프로세스와 멀티 스레드

동시성: 하나의 코어에서 여러 작업을 번갈아가며 처리(콘텍스트 스위칭 - CPU에서 처리 중인 작업을 교체하는 것)

병렬성: CPU가 여러 개 있어서 각 CPU에서 각 작업을 동시에 처리하는 방식

## 멀티 프로세스

: 응용 프로그램 하나를 여러 프로세스로 구성하는 것

- 한 프로세스가 죽어도 다른 프로세스에 영향을 주지 않음
- 안정적
- 시간과 메모리 공간을 많이 사용함
- 오버헤드가 많이 발생 (오버헤드 - CPU에서 기존에 처리하던 프로세스의 메모리 영역을 다른 프로세스가 사용할 수 있도록 교체하면서 필요한 시간과 메모리)

프로세스는 독립적인 메모리를 할당받는다.

따라서 프로세스 간 공유할 자원이 있다면 IPC(Inter Process Communication)를 통해 공유해야함. (직접 참조보다 비효율적)

## 멀티 스레드

: 스레드를 여러 개 생성해 스레드들이 각자 다른 작업을 처리하는것

- 힙, 데이터, 코드 영역 공유 (스택을 제외)
- 콘텍스트 스위칭 시 오버헤드가 적게 발생
- IPC를 사용하지 않아도 되어 멀티 프로세스의 단점 보완
- 자원을 효율적으로 사용 가능
- 자원 공유의 처리 비용이 적고 프로그램 응답 시간 단축됨
- 공유 자원의 동기화 필수
- 스레드에 문제가 생기면 프로세스 내의 다른 스레드에 영향을 끼칠 수 있음

# 1.2.6 콘텍스트 스위칭

인터럽트(interrupt): CPU에서 프로세스를 처리하다 입출력 관련 이벤트 발생 혹은 예외 상황 발생 시 대응할 수 있게 CPU에 처리를 요청하는 것

인터럽트 발생 경우

- 입출력이 발생할 때
- CPU 사용 시간이 만료되었을 때
- 자식 프로세스를 생각할 때

콘텍스트(context): CPU가 처리하는 처리하는 프로세스의 정보를 의미

콘텍스트 스위칭: 멀티 프로세스 환경에서 CU가 처리 중인 프로세스의 정보를 바꾸는 것

처리 중인 프로세스 P1, 다음에 처리해야하는 프로세스 P2

CPU가 P1 처리 중 → 

운영체제가 인터럽트 발생시킴 → 

P1이 유휴 상태로 변경, 스케줄러는 레지스터에 있는 처리 중인 작업 정보를 P1의 PCB에 저장→

스케줄러가 P2의 PCB 정보를 가져와 레지스터에 로드. CPU가 P2 처리.

P1 PCB, P2 PCB 간에 정보를 레지스터에 로드하는 동안 CPU가 아무것도 못하는 상태를 오버헤드가 발생한다고 한다.

프로그램 카운터(PC, Program Counter): 프로세스가 이어서 처리해야 하는 명령의 주소

스택 포인터(stack pointer): 스택 영역에서 데이터가 채워진 가장 높은 주소값을 가리킨다.

이 둘이 주소값을 저장하고 있기 때문에 콘텍스트 스위칭이 원활이 이뤄진다.
