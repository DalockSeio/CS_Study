# 1장 - 운영체제

## 1.2 프로세스

### 1.2.9 스레드 안전

스레드 안전 - 멀티 스레드 환경에서 하나의 변수, 함수, 객체에 스레드 여러 개가 동시 접근해도 문제가 없음

#### 스레드 안전을 위한 조건

* 상호 배제(mutual exclusive) - 공유 자원에 접근해야 할 때 상호배제 기법(1.2.7 참조)을 사용해 접근을 통제해야 함
* 원자 연산(atomic operation) - 공유 자원에 접근할 때 원자 연산을 이용하거나 원자적으로 정의된 연산을 이용해 연산 도중에 다른 스레드가 접근할 수 없게 함
* 재진입성(reentrancy) - 특정 함수를 하나의 스레드에서 실행 중일 때 다른 스레드가 해당 함수를 실행해도 각 스레드에 올바른 결과가 나올 수 있게 함
* 스레드 지역 저장소 - 각 스레드에서만 접근할 수 있는 저장소를 사용해서 공유되는 자원 줄여야 함

➕ 원자 연산이란? "연산 했다", "연산 안 했다" 두 가지만 존재하는 연산

### 1.2.10 IPC

IPC란? 프로세스간 자원을 공유하는 방식

* 공유 메모리

프로세스 간에 공유 가능한 메모리를 구성해 자원을 공유하는 방식
여러 프로세스에서 접근 가능하기에 동기화 문제가 발생할 수 있음

* 소켓

네트워크 소켓을 이용하는 프로세스 간 통신, 외부 시스템과도 이용 가능
클라이언트-서버 구조

* 세마 포어

다수의 프로세스나 스레드가 n개의 공유 자원에 대한 접근을 제한하여 관리하는 동기화 기법

* 파이프
  
FIFO 형태의 메모리인 파이프를 이용해 프로세스 간 자원을 공유하는 방식
단방향 통신만 지원하므로 읽기 또는 쓰기 중 하나만 가능
양방향 통신을 위해서는 읽기, 쓰기 파이프 각각 생성해야 해

* 메시지 큐

FIFO 형태의 큐 자료구조를 사용해 프로세스 간 메시지를 주고 받는 방식

### 1.2.11 좀비 프로세스와 고아 프로세스

좀비 프로세스란? 자식 프로세스가 종료되었지만 부모 프로세스가 자식 프로세스의 종료 상채를 회수하지 않았을 경우에 남겨진 자식 프로세스

* 자식 프로세스 종료 과정

1. 자식 프로세스 -> (SIGCHLD 시그널) -> 부모 프로세스
2. 부모 프로세스 - wait() 함수 호출
3. 자식 프로세스의 상태 정보 받고, 자원 회수 ---> 이 부분이 실패되면 자원이 낭비 되는 좀비 프로세스 생성

고아 프로세스란? 부모 프로세스가 자식 프로세스보다 먼저 종료되는 경우의 자식 프로세스이며 추후 좀비 프로세스가 될 수 있음

좀비 프로세스가 되는 것을 방지하는 법

1. 고아 프로세스의 부모 PID를 init 프로세스의 PID인 1로 바꾸어 줌
2. 고아 프로세스의 부모 프로세스는 init 프로세스가 됨
3. 고아 프로세스가 적업을 종료하면 init 프로세스가 고아 프로세스의 자원을 회수 ---> 자원 낭비/좀비 프로세스화 방지
